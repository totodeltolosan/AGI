name: 🧠 EVE Cognitive Intelligence Validation

on:
  push:
    paths: ['eve/cognitive/**']
  pull_request:
    paths: ['eve/cognitive/**']
  schedule:
    - cron: '0 4 * * *'

jobs:
  cognitive-validation:
    name: Cognitive Systems Validation
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Python
      uses: actions/setup-python@v6
      with:
        python-version: '3.11'
        
    - name: Install AI/ML dependencies
      run: |
        pip install torch transformers scikit-learn numpy pandas
        pip install brain-cognitive-toolkit pytest-ai
        
    - name: Validate Brain Core (cerveau.py refactored)
      run: |
        echo "🧠 VALIDATION SYSTÈME COGNITIF"
        find eve/cognitive/ -name "*.py" | while read file; do
          lines=$(wc -l < "$file")
          if [ $lines -gt 200 ]; then
            echo "❌ CRITIQUE: $file ($lines lignes) - Refactoring requis"
            exit 1
          fi
        done
        
    - name: Test Cognitive Agents
      run: |
        cd eve/cognitive/
        python -m pytest agents/ -v --cov=agents --cov-report=xml
        
    - name: Validate ALMA Integration
      run: |
        python -c "
        import sys
        sys.path.append('eve/cognitive')
        try:
            from brain_core import CognitiveEngine
            from launcher_interface import ALMAInterface  
            print('✅ ALMA Integration: OK')
        except ImportError as e:
            print(f'❌ ALMA Integration Failed: {e}')
            sys.exit(1)
        "
        
    - name: Memory & Learning Tests
      run: |
        cd eve/cognitive/
        python -m pytest tests/test_memory.py tests/test_learning.py -v
