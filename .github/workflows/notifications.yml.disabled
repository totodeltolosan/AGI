name: Project Notifications

on:
  push:
    branches: [ main ]
  pull_request:
    types: [opened, closed, merged]
  issues:
    types: [opened, closed]
  release:
    types: [published]

jobs:
  notify:
    runs-on: ubuntu-latest
    
    steps:
    - name: Slack Notification
      uses: 8398a7/action-slack@v4
      with:
        status: ${{ job.status }}
        custom_payload: |
          {
            channel: '#agi-eve-dev',
            username: 'AGI-EVE Bot',
            icon_emoji: ':robot_face:',
            attachments: [{
              color: '${{ job.status }}' === 'success' ? 'good' : 'danger',
              fields: [{
                title: 'Repository',
                value: '${{ github.repository }}',
                short: true
              }, {
                title: 'Event',
                value: '${{ github.event_name }}',
                short: true
              }, {
                title: 'Branch',
                value: '${{ github.ref }}',
                short: true
              }, {
                title: 'Commit',
                value: '${{ github.sha }}',
                short: true
              }]
            }]
          }
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
      if: always()
