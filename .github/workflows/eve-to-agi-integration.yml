name: EVE to AGI Integration Validation

on:
  pull_request:
    branches: [ agi-main ]
    types: [ opened, synchronize ]

jobs:
  eve-agi-compatibility:
    runs-on: ubuntu-latest
    if: contains(github.head_ref, 'eve')
    
    steps:
    - uses: actions/checkout@v4
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Validate EVE Code Against AGI Constitution
      run: |
        echo "🔍 Validation constitution AGI stricte sur code EVE"
        
        # Appliquer audit AGI strict sur code EVE
        python3 agi_project/tools/compliance_checker/static_auditor.py eve_project/ --strict --limit=200
        
        # Vérifier compatibilité
        bash agi_project/tools/verification_compliance_script.sh eve_project/
    
    - name: Generate Integration Report
      run: |
        echo "📊 Génération rapport intégration EVE→AGI"
        mkdir -p reports/integration/
        echo "EVE Integration Validation Report" > reports/integration/eve_agi_compatibility.md
        echo "Date: $(date)" >> reports/integration/eve_agi_compatibility.md
        echo "Status: Validation AGI constitution sur code EVE" >> reports/integration/eve_agi_compatibility.md
    
    - name: Upload Integration Report
      uses: actions/upload-artifact@v4
      with:
        name: eve-agi-integration-report
        path: reports/integration/
